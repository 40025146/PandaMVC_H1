@model IEnumerable<PandaMVC_H1.Models.客戶銀行資訊>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
@using (Html.BeginForm("SearchColumns", "客戶銀行資訊", "post"))
{
    <table class="table table-bordered">
        <tr><th></th><th>銀行名稱</th><th>銀行代碼</th><th>分行代碼</th><th>帳戶名稱</th><th>帳戶號碼</th><th>客戶名稱</th></tr>
        <tr>
            <td><input type="submit" id="search" class="btn btn-primary" value="搜尋" /></td>
            <td><input type="text" id="銀行名稱" name="銀行名稱" class="form-control" value="" /></td>
            <td><input type="text" id="銀行代碼" name="銀行代碼" class="form-control"  value=""/></td>
            <td><input type="text" id="分行代碼" name="分行代碼" class="form-control"  value=""/></td>
            <td><input type="text" id="帳戶名稱" name="帳戶名稱" class="form-control"  value=""/></td>
            <td><input type="text" id="帳戶名稱" name="帳戶號碼" class="form-control"  value=""/></td>
            <td><input type="text" id="帳戶名稱" name="客戶名稱" class="form-control"  value=""/></td>
        </tr>
    </table>
}

@using (Html.BeginForm("Excel_Export", "客戶銀行資訊", FormMethod.Post))
{
    <table class="table">
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.銀行名稱)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.銀行代碼)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.分行代碼)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.帳戶名稱)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.帳戶號碼)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.客戶資料.客戶名稱)
            </th>
            <th></th>
        </tr>

        @foreach (var item in Model)
        {
            <tr>
                <input type="hidden" name="客戶銀行資訊.Index" value="@item.Id" />

                <td>
                    @Html.DisplayFor(modelItem => item.銀行名稱)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].銀行名稱" value="@item.銀行名稱" />
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.銀行代碼)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].銀行代碼" value="@item.銀行代碼" />
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.分行代碼)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].分行代碼" value="@item.分行代碼" />

                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.帳戶名稱)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].帳戶名稱" value="@item.帳戶名稱" />

                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.帳戶號碼)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].帳戶號碼" value="@item.帳戶號碼" />

                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.客戶資料.客戶名稱)
                    <input type="hidden" name="客戶銀行資訊[@item.Id].客戶資料.客戶名稱" value="@item.客戶資料.客戶名稱" />

                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            </tr>
        }

    </table>
    <input type="submit" value="Excel Export" />
}

